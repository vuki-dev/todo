<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="style.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat&family=Open+Sans&family=Roboto&family=Roboto+Condensed&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/22e1d1208d.js" crossorigin="anonymous"></script>
</head>
<body>
    <div class="new-task-form" id="newTaskForm">
        <div class="button-fixed">
            <button class="new-task-button" id="new-task">New task</button>
        </div> <!-- this stays here because of translate -->

        <textarea name="" class="new-task-input" cols="30" rows="10"></textarea>
        <div class="buttons">
            <div class="buttons-flex">

                <button id="addBtn" class="button-design">Add task</button>
                <button id="closeBtn" class="button-design">Close</button>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="todo">
                
            
        </div>
        
        
        <div class="tasks">
            
            <div class="done cards" id="doneCards">
                <h2>Done tasks &#x2705;</h2>
                <div id="done">

                </div>
            </div>
            <div class="`pending cards" id="pendingCards">
                <h2>Pending tasks &#x231b;</h2>
                <div id="pending">

                </div>
                
            </div>
        </div>
    </div>

    <script>
        var doneTasks = [];
        var pendingTasks = [];

        var doneList = document.getElementById("done");
        var pendingList = document.getElementById("pending");

        var newTaskBtn = document.getElementById("new-task")
        var newTaskForm = document.getElementById("newTaskForm");

        var doneCards = document.getElementById("doneCards");
        var pendingCards = document.getElementById("pendingCards");

        var closeBtn = document.getElementById("closeBtn");
        var addBtn = document.getElementById("addBtn");

        function Task(naziv){
            this.naziv = naziv;
            this.stanje = null;

            this.napraviSe = function(){
                var taskDiv = document.createElement("div");
                taskDiv.classList.add("task-div");

                var taskNaziv = document.createElement("p");
                taskNaziv.innerHTML = this.naziv;


                var checkbox = document.createElement("input");
                checkbox.type = "checkbox"
                checkbox.style.cursor = "pointer";
                if(this.stanje === true){
                    checkbox.checked = true;
                }
                if(this.stanje === false){
                    checkbox.checked = false;
                }


                var delItem = document.createElement("i");
                delItem.classList.add("fa-trash-can")
                delItem.classList.add("fa-solid")
                delItem.classList.add("del-icon")

                delItem.addEventListener("click",() => {
                    if(this.stanje === null | this.stanje === false){
                        for(var i=0; i<pendingTasks.length; i++){
                            console.log("??")
                            if(this.naziv === pendingTasks[i].naziv){
                                console.log(pendingTasks)
                                pendingTasks.splice(i,1);
                                console.log(pendingTasks)
                                prikaziDoneTaskove();
                                prikaziPendingTaskove();
                                return;
                            }
                        }
                    }
                    if(this.stanje === true){
                        for(var i=0; i<doneTasks.length; i++){
                            if(this.naziv === doneTasks[i].naziv){
                                doneTasks.splice(i,1);
                                prikaziDoneTaskove();
                                prikaziPendingTaskove();
                                return;
                            }
                        }
                    }
                    
                })
                

                rightDiv = document.createElement("div");
                rightDiv.classList.add("taskRightDiv")

                rightDiv.appendChild(checkbox)
                rightDiv.appendChild(delItem)
     
                taskDiv.appendChild(taskNaziv)
                taskDiv.appendChild(rightDiv)                
                
                checkbox.addEventListener("change", ()=>{
                    this.stanje = checkbox.checked;
                    
                    console.log(this.stanje)
                    if(this.stanje === true){
                        for(var i = 0; i<pendingTasks.length; i++){
                            if(this.naziv === pendingTasks[i].naziv){
                                doneTasks.unshift(pendingTasks[i]);
                                pendingTasks.splice(i,1);
                                
                                
                                doneList.innerHTML = "";
                                pendingList.innerHTML = "";

                                prikaziDoneTaskove();
                                prikaziPendingTaskove()
                                return;
                            }
                        }
                    }
                    if(this.stanje === false){
                        for(var i = 0; i<doneTasks.length; i++){
                            if(this.naziv === doneTasks[i].naziv){
                                pendingTasks.unshift(doneTasks[i]);
                                doneTasks.splice(i,1);

                                doneList.innerHTML = "";
                                pendingList.innerHTML = "";

                                prikaziDoneTaskove();
                                prikaziPendingTaskove();
                                return;
                            }
                        }
                    }
                    
                })
                
                return taskDiv;

            }
        }

        
        
        
        function prikaziPendingTaskove(task){
            pendingList.innerHTML = "";
            for(var i = 0; i<pendingTasks.length; i++){
                var element = pendingTasks[i].napraviSe();
                pendingList.appendChild(element);
            }
        }

        function prikaziDoneTaskove(){
            doneList.innerHTML = "";
            for(var i = 0; i<doneTasks.length; i++){
                var element = doneTasks[i].napraviSe();
             //   doneTasks[i].checkbox.checked = true;
                element.childNodes[0].style.textDecoration = "line-through"
                doneList.appendChild(element)
                
                
            }
        }


        newTaskBtn.addEventListener("click",() => {
            console.log("klik??")
            doneCards.style.transform = "translateY(150%)"
            pendingCards.style.transform = "translateY(150%)"

            newTaskForm.style.transform = "translateX(-50%) translateY(300px)"

            


        })

        closeBtn.addEventListener("click",()=>{
            newTaskForm.childNodes[5].value = "";

            doneCards.style.transform = "translateY(0)"
            pendingCards.style.transform = "translateY(0)"

            newTaskForm.style.transform = "translateX(-50%) translateY(-400px)"

        })

        addBtn.addEventListener("click",() => {
            pendingTasks.unshift(new Task(newTaskForm.childNodes[5].value))
            doneList.innerHTML = "";
            pendingList.innerHTML = "";
            prikaziPendingTaskove()
            prikaziDoneTaskove()

            doneCards.style.transform = "translateY(0)"
            pendingCards.style.transform = "translateY(0)"

            newTaskForm.style.transform = "translateX(-50%) translateY(-400px)"

            newTaskForm.childNodes[5].value = "";

        })


        prikaziPendingTaskove()
        prikaziDoneTaskove()

        // test git commit
        // test git commit #2 
        // test git commit #3 and #4
        
        
        



    </script>
    
</body>
</html>